# PII Protection Security Rules
# Prevents exposure of personally identifiable information

name: pii-protection
description: Protects personally identifiable information from exposure
version: "1.0"

rules:
  secrets:
    enabled: true
    severity: critical
    action: block
    patterns:
      # SSN (US Social Security Number)
      - "\\b\\d{3}-\\d{2}-\\d{4}\\b"
      - "\\b\\d{9}\\b"  # SSN without dashes

      # Credit Cards (with Luhn validation recommended)
      - "\\b4[0-9]{12}(?:[0-9]{3})?\\b"  # Visa
      - "\\b5[1-5][0-9]{14}\\b"  # Mastercard
      - "\\b3[47][0-9]{13}\\b"  # Amex
      - "\\b6(?:011|5[0-9]{2})[0-9]{12}\\b"  # Discover
      - "\\b3(?:0[0-5]|[68][0-9])[0-9]{11}\\b"  # Diners

      # Bank Account Numbers (IBAN)
      - "\\b[A-Z]{2}[0-9]{2}[A-Z0-9]{4}[0-9]{7}([A-Z0-9]?){0,16}\\b"

      # Phone Numbers (various formats)
      - "\\b\\+?1?[-.]?\\(?\\d{3}\\)?[-.]?\\d{3}[-.]?\\d{4}\\b"

      # Email addresses (for bulk extraction prevention)
      - "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b"

      # Passport Numbers
      - "\\b[A-Z]{1,2}[0-9]{6,9}\\b"

      # Driver's License (generic US patterns)
      - "\\b[A-Z]{1,2}[0-9]{5,8}\\b"

      # Date of Birth patterns
      - "\\b(0[1-9]|1[0-2])/(0[1-9]|[12]\\d|3[01])/(19|20)\\d{2}\\b"
      - "\\b(19|20)\\d{2}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])\\b"

  sanitization:
    enabled: true
    severity: high
    action: block
    redactMatches: true
