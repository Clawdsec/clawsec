# Secrets Management Security Rules
# Protects secrets management service credentials

name: secrets-management
description: Security rules for secrets management services
version: "1.0"

rules:
  secrets:
    enabled: true
    severity: critical
    action: block
    patterns:
      # HashiCorp Vault
      - "VAULT_TOKEN"
      - "VAULT_ADDR"
      - "hvs\\.[a-zA-Z0-9_-]{24}"
      - "s\\.[a-zA-Z0-9]{24}"

      # AWS Secrets Manager
      - "aws secretsmanager get-secret-value"
      - "secretsmanager:GetSecretValue"

      # GCP Secret Manager
      - "gcloud secrets versions access"
      - "secretmanager.versions.access"

      # Azure Key Vault
      - "AZURE_KEYVAULT"
      - "az keyvault secret show"

      # 1Password
      - "OP_SESSION"
      - "op://.*"

      # Doppler
      - "DOPPLER_TOKEN"
      - "dp\\.pt\\.[a-zA-Z0-9]+"

      # Infisical
      - "INFISICAL_TOKEN"

      # Bitwarden
      - "BW_SESSION"
      - "BW_CLIENTSECRET"

      # LastPass
      - "LASTPASS_"

      # CyberArk
      - "CYBERARK_"

  destructive:
    enabled: true
    severity: critical
    action: block
    patterns:
      - "vault secrets disable"
      - "vault auth disable"
      - "aws secretsmanager delete-secret"
      - "gcloud secrets delete"
      - "az keyvault secret delete"
      - "az keyvault delete"
